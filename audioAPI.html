<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>吴天赐 - AudioAPI</title>
</head>
<body>
    <buttion id="btn">播放</buttion>
<script type="text/javascript">
window.onload = function(){
    var audio = new Audio();
    var btn = document.getElementById('btn');
    btn.onclick = function(){
        audio.src="audio/music_00.mp3";
        audio.preload = "metadata"
        audio.play();
        var i=0;
        var buffered, percent;
        // 已缓冲部分
        audio.readyState == 4 && (buffered = audio.buffered.end(0));
        // 已缓冲百分百
        audio.readyState == 4 && (percent = Math.round(buffered / audio.duration * 100) + '%');
        
        
        var timer = setInterval(function(){
            console.log(percent);
           /* if(i<300){
            console.log(audio.currentTime);
            console.log(audio.duration);
            }
            i++;
            */
            //获取已缓冲部分的 TimeRanges 对象
            var timeRanges  = audio.buffered;
            console.log('1-'+timeRanges);
            
            // 获取以缓存的时间
            var timeBuffered = timeRages.end(timeRages.length - 1);
            console.log('2-'+timeBuffered);
        },10);
        
    }
}
</script>
</body>
</html>
